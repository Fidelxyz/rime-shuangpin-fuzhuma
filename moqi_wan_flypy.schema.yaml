# Rime schema
# encoding: utf-8
# https://github.com/gaboolic/rime-shuangpin-fuzhuma
#Lua 配置: 超级注释模块
pro_comment_format:                   # 超级注释，子项配置 true 开启，false 关闭
  fuzhu_code: true                    # 启用辅助码提醒，用于辅助输入练习辅助码，成熟后可关闭
  candidate_length: 1                 # 候选词辅助码提醒的生效长度，0为关闭  但同时清空其它，应当使用上面开关来处理
  fuzhu_type: flypy                     # 用于匹配对应的辅助码注释显示，可选显示类型有：moqi, flypy, zrm, jdh, cj, tiger, wubi,选择一个填入，应与上面辅助码类型一致

  corrector: true                     # 启用错音错词提醒，例如输入 geiyu 给予 获得 jiyu 提示
  corrector_type: "{comment}"         # 新增一个显示类型，比如"【{comment}】"

schema:
  schema_id: moqi_wan_flypy
  name: 墨奇万象+小鹤双拼·鹤形
  version: "2024-05-11"
  author:
    - gaboolic
  description: |
    墨奇辅助码 小鹤双拼版 大词库版本 非自动上屏，支持4万字 https://github.com/gaboolic/rime-shuangpin-fuzhuma/wiki/%E5%A2%A8%E5%A5%87%E7%A0%81%E6%8B%86%E5%88%86%E8%A7%84%E5%88%99
  dependencies:
    - radical_flypy
    - stroke
    - easy_en

switches:
  __include: moqi.yaml:/switches_engine/switches
engine:
  __include: moqi.yaml:/switches_engine/engine

# 置顶
custom_phrase:
  __include: moqi.yaml:/phrase/custom_phrase
custom_phrase_super_3jian_no_conflict:
  __include: moqi.yaml:/phrase/custom_phrase_super_3jian_no_conflict
custom_phrase_super_4jian_no_conflict:
  __include: moqi.yaml:/phrase/custom_phrase_super_4jian_no_conflict
custom_phrase_kf:
  __include: moqi.yaml:/phrase/custom_phrase_kf
custom_phrase_mqzg:
  __include: moqi.yaml:/phrase/custom_phrase_mqzg
custom_phrase_super_1jian:
  __include: moqi.yaml:/phrase/custom_phrase_super_1jian
custom_phrase_super_2jian:
  __include: moqi.yaml:/phrase/custom_phrase_super_2jian
custom_phrase_super_3jian:
  __include: moqi.yaml:/phrase/custom_phrase_super_3jian

# 反查配置
radical_flypy:
  __include: moqi.yaml:/reverse/radical_flypy
reverse_stroke:
  __include: moqi.yaml:/reverse/reverse_stroke
reverse_lookup:
  __include: moqi.yaml:/reverse/reverse_lookup

# OpenCC 配置
chaifen:
  __include: moqi.yaml:/opencc_config/chaifen
chaifen_all:
  __include: moqi.yaml:/opencc_config/chaifen_all
chinese_english:
  __include: moqi.yaml:/opencc_config/chinese_english
traditionalize:
  __include: moqi.yaml:/opencc_config/traditionalize
mars:
  __include: moqi.yaml:/opencc_config/mars

# 标点
punctuator:
  __include: moqi.yaml:/punctuator/punctuator

# 引导前缀配置
recognizer:
  __include: moqi.yaml:/guide/recognizer
easy_en_simp:
  __include: moqi.yaml:/guide/easy_en_simp
calculator:
  __include: moqi.yaml:/guide/calculator
date_translator:
  __include: moqi.yaml:/guide/date_translator
lunar:
  __include: moqi.yaml:/guide/lunar
long_word_filter:
  __include: moqi.yaml:/guide/long_word_filter

# 大字集、自造词
big_char_set:
  __include: moqi.yaml:/big_char_and_user_dict/big_char_set
user_dict_set:
  __include: moqi.yaml:/big_char_and_user_dict/user_dict_set
add_user_dict:
  __include: moqi.yaml:/big_char_and_user_dict/add_user_dict

speller:
  max_code_length: 5
  auto_select: false
  auto_select_pattern: ^[a-z]+/|^[a-df-zA-DF-Z]\w{3}|^e\w{4}|;[a-z]
  alphabet: zyxwvutsrqponmlkjihgfedcbaZYXWVUTSRQPONMLKJIHGFEDCBA[/|
  initials: zyxwvutsrqponmlkjihgfedcbaZYXWVUTSRQPONMLKJIHGFEDCBA
  delimiter: " '"
  algebra:
    __include: moqi_speller.yaml:/flypy_speller
    __append:
      # flypy_aux - 小鹤形辅助码
      - xform/^(.{2}|\w+?);.*?;(.*?);.*$/$1;$2/
      # common_aux - 通用辅助码处理
      - derive/^(.{2}|\w+?);.*$/$1/ # 纯双拼的情况
      - derive/^(.{2}|\w+?);(\w)(\w).*$/$1$2/ # 双拼+一位辅助码的情况
      - derive/^(.{2}|\w+?);(\w)(\w).*$/$1[$2/ # 双拼+[一位辅助码的情况
      - derive/^(.{2}|\w+?);.*?,(\w)(\w).*$/$1$2/ # 双拼+一位辅助码的情况
      - derive/^(.{2}|\w+?);.*?,(\w)(\w).*$/$1[$2/ # 双拼+[一位辅助码的情况
      - abbrev/^(.{2}|\w+?);(\w)(\w).*$/$1$2$3/ # 双拼+2位辅助码的情况
      - abbrev/^(.{2}|\w+?);.*?,(\w)(\w).*$/$1$2$3/ # 双拼+2位辅助码的情况
      - derive/^(.{2}|\w+?);(\w)(\w).*$/$1$2$3o/ # 整句模式下，输入syffo 出单字
      - derive|^(.{2});(\w)(\w).*$|$1$2$3/| # 整句模式下，输入syff/ 出单字
      - derive|^(\w+?);(\w)(\w).*$|$1$2$3/| # 整句模式下，输入syff/ 出单字
      - derive/^(.{2}|\w+?);.*,(\w)(\w).*$/$1$2$3o/ # 整句模式下，输入syffo 出单字
      - derive|^(.{2});.*,(\w)(\w).*$|$1$2$3/| # 整句模式下，输入syff/ 出单字
      - derive|^(\w+?);.*,(\w)(\w).*$|$1$2$3/| # 整句模式下，输入syff/ 出单字

translator:
  dictionary: moqi_wan.extended
  prism: moqi_wan_flypy
  initial_quality: 10000
  enable_completion: false
  spelling_hints: 10
  comment_format: {comment}
  enable_user_dict: false
  preedit_format:

# 快捷键
key_binder:
  import_preset: default
  bindings:
    - { when: composing, accept: Control+m, send: Return }
    - { when: composing, accept: Control+w, send: Control+BackSpace }
    - { when: has_menu, accept: semicolon, send: 2 }
    - { when: composing, accept: Control+i, send: Shift+Right }
    - { when: composing, accept: Control+o, send: Shift+Left }
    - { when: has_menu, accept: "Control+p", toggle: chaifen }
    - { when: has_menu, accept: "Control+l", toggle: chaifen_all }
    - { when: has_menu, accept: "Control+e", toggle: chinese_english }
    - { match: "[a-z]{1,3}", accept: Tab,  send_sequence: "/1" }
    - { match: "[a-z]{1,3}", accept: "/",  send_sequence: "/1" }
    - { match: "[a-z]{1,3}", accept: ".",  send_sequence: "/1" }
    - { when: composing, accept: Control+1, send_sequence: '{Home}{Shift+Right}[' }
    - { when: composing, accept: Control+2, send_sequence: '{Home}{Shift+Right}{Shift+Right}[' }
    - { when: composing, accept: Control+3, send_sequence: '{Home}{Shift+Right}{Shift+Right}{Shift+Right}[' }
    - { when: composing, accept: Control+4, send_sequence: '{Home}{Shift+Right}{Shift+Right}{Shift+Right}{Shift+Right}[' }
    - { when: composing, accept: Control+5, send_sequence: '{Home}{Shift+Right}{Shift+Right}{Shift+Right}{Shift+Right}{Shift+Right}[' }
    - { when: composing, accept: Control+6, send_sequence: '{Home}{Shift+Right}{Shift+Right}{Shift+Right}{Shift+Right}{Shift+Right}{Shift+Right}[' }
    - { when: composing, accept: Control+7, send_sequence: '{Home}{Shift+Right}{Shift+Right}{Shift+Right}{Shift+Right}{Shift+Right}{Shift+Right}{Shift+Right}[' }
    - { when: has_menu, accept: Shift+A, send_sequence: "{Shift+Right}a{Shift+Right}" }
    - { when: has_menu, accept: Shift+B, send_sequence: "{Shift+Right}b{Shift+Right}" }
    - { when: has_menu, accept: Shift+C, send_sequence: "{Shift+Right}c{Shift+Right}" }
    - { when: has_menu, accept: Shift+D, send_sequence: "{Shift+Right}d{Shift+Right}" }
    - { when: has_menu, accept: Shift+E, send_sequence: "{Shift+Right}e{Shift+Right}" }
    - { when: has_menu, accept: Shift+F, send_sequence: "{Shift+Right}f{Shift+Right}" }
    - { when: has_menu, accept: Shift+G, send_sequence: "{Shift+Right}g{Shift+Right}" }
    - { when: has_menu, accept: Shift+H, send_sequence: "{Shift+Right}h{Shift+Right}" }
    - { when: has_menu, accept: Shift+I, send_sequence: "{Shift+Right}i{Shift+Right}" }
    - { when: has_menu, accept: Shift+J, send_sequence: "{Shift+Right}j{Shift+Right}" }
    - { when: has_menu, accept: Shift+K, send_sequence: "{Shift+Right}k{Shift+Right}" }
    - { when: has_menu, accept: Shift+L, send_sequence: "{Shift+Right}l{Shift+Right}" }
    - { when: has_menu, accept: Shift+M, send_sequence: "{Shift+Right}m{Shift+Right}" }
    - { when: has_menu, accept: Shift+N, send_sequence: "{Shift+Right}n{Shift+Right}" }
    - { when: has_menu, accept: Shift+O, send_sequence: "{Shift+Right}o{Shift+Right}" }
    - { when: has_menu, accept: Shift+P, send_sequence: "{Shift+Right}p{Shift+Right}" }
    - { when: has_menu, accept: Shift+Q, send_sequence: "{Shift+Right}q{Shift+Right}" }
    - { when: has_menu, accept: Shift+R, send_sequence: "{Shift+Right}r{Shift+Right}" }
    - { when: has_menu, accept: Shift+S, send_sequence: "{Shift+Right}s{Shift+Right}" }
    - { when: has_menu, accept: Shift+T, send_sequence: "{Shift+Right}t{Shift+Right}" }
    - { when: has_menu, accept: Shift+U, send_sequence: "{Shift+Right}u{Shift+Right}" }
    - { when: has_menu, accept: Shift+V, send_sequence: "{Shift+Right}v{Shift+Right}" }
    - { when: has_menu, accept: Shift+W, send_sequence: "{Shift+Right}w{Shift+Right}" }
    - { when: has_menu, accept: Shift+X, send_sequence: "{Shift+Right}x{Shift+Right}" }
    - { when: has_menu, accept: Shift+Y, send_sequence: "{Shift+Right}y{Shift+Right}" }
    - { when: has_menu, accept: Shift+Z, send_sequence: "{Shift+Right}z{Shift+Right}" }

__patch:
  add_user_dict/dictionary: moqi_wan.extended
  user_dict_set/dictionary: moqi_wan.extended
  user_dict_set/prism: moqi_wan_flypy
  add_user_dict/prism: moqi_wan_flypy
  big_char_set/prism: moqi_wan_flypy
